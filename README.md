# terraform-aws-threetierapp
#### Terraform code that creates a VPC with all the networking and then deploys a 3 tier application onto the stack. The web tier has multiple EC2 instances (across AZs) with NGINX servers installed on them that run a sample Angular app. The instances are front-ended by an external ALB. An alias DNS record is created in an existing DNS hosted zone that points at the public ALB. The app tier has multiple EC2 instances (across AZs) with a sample Spring boot (REST API) application installed on them. The instances are front-ended by an internal ALB. The NGINX servers also act as reverse proxies for the Spring boot application. A private DNS hosted zone (accessible only from the VPC) is created and an alias DNS record is created in it that points at the private ALB. The web servers call the REST API on the private ALB and display the results on the front-end. The database tier is a work in progress at this point. Once built, it will be used by the app tier to fetch records.  

The code has the following modules - 
* **Networking** - For VPC and all the related networking. We are using the 10.16.0.0/16 CIDR for the VPC and 16 /20 subnets (4 each for web, app, db and reserved). The subnets are spread across 4 AZs for high availability. This also creates a Gateway endpoint for S3 and multiple Interface endpoints in the App subnets for Sessions Manager.
* **Compute** - For the launch templates, EC2 instances, instance profiles and security groups. The compute module first builds launch templates complete with user data and other settings and uses that to launch web and app instances in their respective ASGs. The Angular and Spring boot code resides in an S3 bucket that is pulled by the EC2 instances during bootstrapping.
* **Load Balancing** -  For setting up the ASGs, ALBs, target groups, target group attachments and listeners for both web and app tiers. 
* **DNS** - This is for creating an alias record to the web ALB (internet facing) in an existing public hosted zone. It also creates a private hosted zone (accessible only from the VPC) and an alias record in it that points at the app (internal) ALB.
* **Root** - This is the root module for orchestration between the other modules. The dynamic values are passed in from here to the modules. This makes the modules re-usable. 
